generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Order {
  id            Int         @id @default(autoincrement())
  username      String
  email         String
  city          String
  postalCode    String
  streetAddress String
  province      String
  phonenumber   String
  paid          Boolean
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  totalPrice    Float
  status        OrderStatus @default(PAGO_PENDIENTE)
  paymentId     String?
  items         OrderItem[]
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  orderId   Int
  productId Int
  quantity  Int
  order     Order   @relation(fields: [orderId], references: [id])
  product   Product @relation(fields: [productId], references: [id])
}

model Product {
  id          Int         @id @default(autoincrement())
  name        String
  description String
  brand       String
  price       Float
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @default(now())
  stock       Int         @default(0)
  images      Image[]
  likes       Like[]
  orderItems  OrderItem[]
  properties  Properties?
}

model Like {
  id        Int      @id @default(autoincrement())
  userId    String
  productId Int
  createdAt DateTime @default(now())
  product   Product  @relation(fields: [productId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, productId])
}

model Properties {
  id               Int      @id @default(autoincrement())
  model            String
  capacity         String
  ram              String
  color            String
  battery          String?
  processor        String?
  graphics         String?
  chipset          String?
  connectivity     String?
  navigation       String?
  audio            String?
  sensors          String?
  features         String?
  weight           String?
  dimensions       String?
  fastcharging     Boolean?
  frontcamera      String?
  network2g        String?
  network3g        String?
  network4g        String?
  network5g        String?
  operatingsystem  String?
  rearcamera       String?
  screenresolution String?
  screensize       String?
  screentype       String?
  productId        Int?     @unique
  simcard          String?
  product          Product? @relation(fields: [productId], references: [id])
}

model Image {
  id        Int      @id @default(autoincrement())
  url       String
  productId Int?
  product   Product? @relation(fields: [productId], references: [id], onDelete: Cascade)
}

model User {
  id               String         @id @default(cuid())
  name             String?
  email            String         @unique
  emailVerified    DateTime?
  image            String?
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
  role             UserRole       @default(USER)
  passwordHash     String?
  codeExpiresAt    DateTime?
  verificationCode String?
  accounts         Account[]
  likes            Like[]
  sessions         Session[]
  shipments        ShipmentData[]
}

model ShipmentData {
  id           Int      @id @default(autoincrement())
  phoneNumber  String?
  streetName   String?
  streetNumber String?
  province     String?
  city         String?
  postalCode   String?
  apartment    String?
  floor        String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  userId       String
  observations String?
  user         User     @relation(fields: [userId], references: [id])
}

model Account {
  userId            String
  providerAccountId String
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  access_token      String?
  expires_at        Int?
  id_token          String?
  provider          String
  refresh_token     String?
  scope             String?
  session_state     String?
  token_type        String?
  type              String
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@id([provider, providerAccountId])
}

model Session {
  userId       String
  expires      DateTime
  sessionToken String   @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model VerificationToken {
  identifier String
  token      String
  expires    DateTime

  @@id([identifier, token])
}

enum OrderStatus {
  PAGO_PENDIENTE
  ENVIO_PENDIENTE
  ENVIADO
  ENTREGADO
}

enum UserRole {
  ADMIN
  USER
}
